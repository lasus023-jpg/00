<!DOCTYPE html>
<html lang="id" data-bs-theme="dark">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Judul novel - XX bab</title>
  
  <link href="https://fonts.googleapis.com/css2?family=Merriweather&family=Inter&family=Roboto+Mono&display=swap" rel="stylesheet">
  
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.8/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-sRIl4kxILFvY47J16cr9ZwB07vP4J8+LH7qKQnuqkuIAvNWLzeN8tE5YBujZqJLB" crossorigin="anonymous">
  
  
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.8/dist/js/bootstrap.bundle.min.js" integrity="sha384-FKyoEForCGlyvwx9Hj09JcYn3nv7wiPVlz7YYwJrWVcXK/BmnVDxM+D2scQbITxI" crossorigin="anonymous"></script>
  
 
<style>
    
     /* Style untuk tata letak halaman */
    body {
      font-family: Merriweather, Arial, sans-serif;
      margin: 0;
      padding: 0;
      line-height: 1.6;
       /* background-color: #f9f9f9; */
      color: #f3aa00;
      transition: background-color 0.3s, color 0.3s;
    }

    .container {
      max-width: 800px;
      margin: 0 auto;
      padding: 1px;
      background: white;
      box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
      border-radius: 8px;
      transition: background-color 0.3s;
    }

    h1 {
      text-align: center;
      margin-bottom: 20px;
    }

    /* Kustomisasi Utterances */
    .utterances {
      margin-top: 30px;
      border: 1px solid #ddd;
      border-radius: 8px;
      box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
    }

    .utterances-frame {
      width: 100%;
      border: none;
      border-radius: inherit;
    }

    /* Tombol Mode Gelap/Terang */
    .theme-switch {
      display: flex;
      justify-content: center;
      margin-top: 20px;
    }

    .theme-switch button {
      padding: 10px 20px;
      font-size: 1rem;
      border: 2px solid #333;
      background: transparent;
      border-radius: 5px;
      cursor: pointer;
      transition: background-color 0.3s, color 0.3s;
    }

    .theme-switch button:hover {
      background-color: #333;
      color: #fff;
    }

    /* Gaya untuk Mode Gelap */
    body.dark {
      background-color: #1e1e1e;
      color: #f1f1f1;
    }

    .container.dark {
      background-color: #292929;
    }

    .theme-switch button.dark {
      border: 2px solid #f1f1f1;
      color: #f1f1f1;
    }

    .theme-switch button.dark:hover {
      background-color: #f1f1f1;
      color: #333;
    }

    .accordion-item.dark .accordion-header button {
      background-color: #333;
      color: #f1f1f1;
    }

    .accordion-item.dark .accordion-body {
      background-color: #444;
      color: #f1f1f1;
    }
    .navbar {
  font-family: Inter, system-ui, sans-serif;
    }

body {
  padding-top: 6px; /* mencegah konten ketutup navbar */
    }
    mark {
  background-color: #ffe066;
  padding: 0 2px;
  border-radius: 3px;
}

body.dark mark {
  background-color: #ffb703;
  color: #111;
    }
    
    #searchInput { 
    display: none; }
    
    
    .modal-body {
  padding-bottom: 2rem;
} /* lebih nyaman ngetik di mobile */
    
    
  .toc-link.active {
  font-weight: 600;
  text-decoration: underline;
}
    
    #novelInfoModal img {
  box-shadow: 0 4px 16px rgba(0,0,0,.15);
}
    
.accordion-body {
  line-height: 1.8;
}

.accordion-body button {
  min-width: 12px;
        }
    
</style>

<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.13.1/font/bootstrap-icons.min.css">

  
</head>


<body>
    
    <h3 align="center" data-bs-toggle="modal"
        data-bs-target="#judi">Ubah judul header</h3>
    
   
   
    
  
  
   <nav class="navbar navbar-expand-lg navbar-dark bg-dark sticky-top shadow-sm">
  <div class="container-fluid">

    <span class="navbar-brand small">
   <button class="btn btn-sm btn-outline-light ms-2" data-bs-toggle="modal"
        data-bs-target="#judi"> üìó </button>
        
        <button class="btn btn-sm btn-outline-secondary"
        data-bs-toggle="modal"
        data-bs-target="#tocModal">
  <i class="bi bi-journal-arrow-down"></i>
</button>
    </span>
    
    
        
    

    <!-- Search -->
    <form class="d-flex ms-auto me-3" role="search">
      <input id="searchInput"
             class="form-control form-control-sm"
             type="search"
             placeholder="Cari teks..."
             aria-label="Search">
    </form>
    
    <button class="btn btn-sm btn-outline-light ms-2"
        data-bs-toggle="modal"
        data-bs-target="#commentModal">
  üí¨
</button>




    
    <button class="btn btn-sm btn-outline-light ms-2" id="darkModeToggle" onclick="toggleDarkMode()">
            <i class="bi bi-moon-fill"></i>
        </button>


  </div>
</nav> 
    
    <div class='container mb-5'>
<div class="accordion" id="accordionExample">
        
     

            
<!-- batas akhir div accordion -->   
      </div>
    </div>
    
    
    
<!-- JSON generator bab dan lainnya -->



        <!--  modal TOC (mobile friendly) -->


<div class="modal fade" id="tocModal" tabindex="-1">
  <div class="modal-dialog modal-dialog-centered modal-dialog-scrollable">
    <div class="modal-content">

      <div class="modal-header">
        <h5 class="modal-title">Daftar Isi</h5>
        <button type="button" class="btn-close" data-bs-dismiss="modal" ></button>
      </div>

      <div class="modal-body">
        <nav id="toc">
          <ul class="list-unstyled mb-0"></ul>
        </nav>
      </div>

    </div>
  </div>
</div>





    <!-- div Toast -->
    
    <div class="toast-container position-fixed top-0 end-0 p-3" style="z-index: 1100;">
  <div id="searchToast"
       class="toast align-items-center text-bg-dark border-0"
       role="alert"
       aria-live="assertive"
       aria-atomic="true">
    <div class="d-flex">
      <div id="toastBody" class="toast-body">
        0 hasil ditemukan
      </div>
      <button type="button"
              class="btn-close btn-close-white me-2 m-auto"
              data-bs-dismiss="toast"
              aria-label="Close"></button>
    </div>
  </div>
</div>

        <!-- bagian div modal -->

<div class="modal fade" id="commentModal" tabindex="-1" aria-hidden="true">
  <div class="modal-dialog modal-dialog-centered modal-dialog-scrollable modal-lg">
    <div class="modal-content">

      <div class="modal-header">
        <h5 class="modal-title">üí¨ Komentar</h5>
        <button type="button"
                class="btn-close"
                data-bs-dismiss="modal"
                aria-label="Close"></button>
      </div>

      <div class="modal-body">

        <!-- SECTION KOMENTAR -->
        <section class="comments">
          <script src="https://utteranc.es/client.js"
                  repo="lasus023-jpg/00"
                  issue-term="pathname"
                  theme="github-light"
                  crossorigin="anonymous"
                  async>
          </script>
        </section>

      </div>

    </div>
  </div>
</div>



<!-- div modal untuk judul buku -->

<div class="modal fade" id="judi" tabindex="-1">
  <div class="modal-dialog modal-dialog-centered modal-dialog-scrollable">
    <div class="modal-content">

      <div class="modal-header">
        <h5 class="modal-title">Viral Sejuta Like!</h5>
        <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
      </div>

      <div class="modal-body">

        <!-- Sampul -->
        <img src="cover.png"
             alt="Sampul Novel Viral Sejuta Like"
             class="img-fluid rounded mb-3">

        <!-- Metadata -->
        <p class="small text-muted mb-1">
          Genre: Drama, Cinta, Media Sosial
        </p>

        <!-- Ringkasan -->
        <p>
          Di era ketika jumlah like bisa menentukan harga diri,
          seorang gadis sederhana mendadak viral karena satu unggahan
          yang tak ia rencanakan. Popularitas membawa cinta,
          konflik, dan pilihan sulit antara menjadi diri sendiri
          atau menjadi apa yang diinginkan dunia maya.
        </p>

        <p class="mb-0">
          Novel ini mengajak pembaca menyelami dinamika hubungan,
          tekanan sosial media, dan arti ketulusan di balik layar.
        </p>

      </div>

    </div>
  </div>
</div>






<!-- menjelang </body> -->


<script>
fetch('bab.json')
  .then(res => res.json())
  .then(babs => {

    const acc = document.getElementById('accordionExample');
    const tocList = document.querySelector('#toc ul');

    // ==== 1. GENERATE ACCORDION ====
    acc.innerHTML = babs.map((b, i) => `
      <div class="accordion-item" id="${b.id}" data-file="${b.file}">
        <h2 class="accordion-header">
          <button class="accordion-button collapsed"
                  type="button"
                  data-bs-toggle="collapse"
                  data-bs-target="#c-${b.id}">
            Bab ${i + 1} ‚Äî ${b.judul}
          </button>
        </h2>
        <div id="c-${b.id}"
             class="accordion-collapse collapse"
             data-bs-parent="#accordionExample">
          <div class="accordion-body"></div>
        </div>
      </div>
    `).join('');

    // ==== 2. GENERATE DAFTAR ISI ====
   tocList.innerHTML = babs.map((b, i) => `
  <li>
    <a href="#${b.id}"
       class="toc-link d-block py-2 text-decoration-none"
       data-bs-dismiss="modal">
      ${i + 1}. ${b.judul}
    </a>
  </li>
`).join('');

    // ==== 3. BUKA BAB DARI HASH (deep-link) ====
    const hash = location.hash.slice(1);
    if (!hash) return;

    const item = document.getElementById(hash);
    if (!item) return;

    const collapse = item.querySelector('.accordion-collapse');
    if (!collapse) return;

    new bootstrap.Collapse(collapse, { toggle: true });

    const header = item.querySelector('.accordion-header');
    header.scrollIntoView({ behavior: 'smooth', block: 'start' });
  });
  
  window.addEventListener('hashchange', () => {
  document.querySelectorAll('.toc-link').forEach(a => {
    a.classList.toggle('active', a.getAttribute('href') === location.hash);
  });
  
  
  <!-- generate untuk modal daftar isi -->
  const tocList = document.querySelector('#toc ul');




<!-- fungsi untuk update -->
function updateTOCActive() {
  document.querySelectorAll('.toc-link').forEach(a => {
    a.classList.toggle(
      'fw-bold',
      a.getAttribute('href') === location.hash
    );
  });
}

window.addEventListener('hashchange', updateTOCActive);
updateTOCActive();


  
});



</script>




<!-- hash -->


<script>
document
  .getElementById('accordionExample')
  .addEventListener('shown.bs.collapse', function (e) {

    const item = e.target.closest('.accordion-item');
    if (!item || !item.id) return;

    // update URL hash tanpa reload
    history.replaceState(null, '', `#${item.id}`);
  });
</script>



<!-- modal yg muncul auto ke kotak komen -->
<script>
document.getElementById('commentModal')
  .addEventListener('shown.bs.modal', () => {
    document.querySelector('.utterances-frame')?.scrollIntoView({
      behavior: 'smooth'
    });
  });
</script>



<!-- test modal judul buku -->

<script>
document.getElementById('judi')
  .addEventListener('shown.bs.modal', () => {
  });
  
  </script>


    
    <!-- fungsi Toast helper -->
    
    <script>
const toastEl = document.getElementById('searchToast');
const toastBody = document.getElementById('toastBody');
const toast = new bootstrap.Toast(toastEl, { delay: 2000 });

function showResultCount(count) {
  if (!searchInput.value.trim()) return;

  toastBody.textContent =
    count === 0
      ? '‚ùå Tidak ada hasil'
      : `üîé ${count} hasil ditemukan`;

  toast.show();
}
</script>
    
    
    <!-- fungsi highlight -->
    
    <script>
function removeHighlight(element) {
  element.querySelectorAll('mark').forEach(mark => {
    mark.replaceWith(document.createTextNode(mark.textContent));
  });
}

function highlightText(element, keyword) {
  if (!keyword) return;

  const regex = new RegExp(`(${keyword})`, 'gi');

  element.childNodes.forEach(node => {
    if (node.nodeType === Node.TEXT_NODE) {
      if (regex.test(node.textContent)) {
        const span = document.createElement('span');
        span.innerHTML = node.textContent.replace(regex, '<mark>$1</mark>');
        node.replaceWith(span);
      }
    } else if (node.nodeType === Node.ELEMENT_NODE && node.tagName !== 'MARK') {
      highlightText(node, keyword);
    }
  });
}
</script>
    
    
    <!-- fungsi search input -->
    
   <script>
const searchInput = document.getElementById('searchInput');
const accordion = document.getElementById('accordionExample');

searchInput.addEventListener('input', function () {
  const keyword = this.value.toLowerCase().trim();
  const items = accordion.querySelectorAll('.accordion-item');

  let firstMatch = null;
  let matchCount = 0;

  items.forEach(item => {
    const button = item.querySelector('.accordion-button');
    const body = item.querySelector('.accordion-body');
    const collapse = item.querySelector('.accordion-collapse');
    const text = item.innerText.toLowerCase();

    removeHighlight(body);
    removeHighlight(button);

    if (keyword && text.includes(keyword)) {
      matchCount++;
      item.style.display = '';
      
      
      // buka accordion
      const bs = bootstrap.Collapse.getOrCreateInstance(collapse, {
        toggle: false
      });
      bs.show();

      // highlight kata
      highlightText(body, keyword);

      if (!firstMatch) firstMatch = item;
    } else if (keyword) {
      item.style.display = 'none';
    } else {
      // reset total
      item.style.display = '';
      bootstrap.Collapse.getOrCreateInstance(collapse, {
        toggle: false
      }).hide();
    }
  });

  if (firstMatch) {
    firstMatch.scrollIntoView({
      behavior: 'smooth',
      block: 'start'
    });
  }


showResultCount(matchCount);
});
</script> 
    
    
    <!-- fungsi mode gelap -->
    <script>
        // Fungsi JavaScript untuk mengganti mode
        function toggleDarkMode() {
            const htmlElement = document.documentElement;
            const currentTheme = htmlElement.getAttribute('data-bs-theme');
            const toggleButton = document.getElementById('darkModeToggle');
            
            if (currentTheme === 'light') {
                htmlElement.setAttribute('data-bs-theme', 'dark');
                toggleButton.innerHTML = '<i class="bi bi-sun-fill"></i>'; // Ganti ikon menjadi matahari
            } else {
                htmlElement.setAttribute('data-bs-theme', 'light');
                toggleButton.innerHTML = '<i class="bi bi-moon-fill"></i>'; // Ganti ikon menjadi bulan
            }
        }
    </script>
 
    
    
    <!-- fungsi fetch body akor -->
     
    
    <script>
async function loadAccordionContent(item) {
  const file = item.dataset.file;
  const body = item.querySelector('.accordion-body');

  if (!file || body.dataset.loaded) return;

  try {
    const response = await fetch(file);
    if (!response.ok) throw new Error('File tidak ditemukan');

    const text = await response.text();
    body.innerHTML = text;
    body.dataset.loaded = 'true'; // cache
  } catch (err) {
    body.textContent = `Error: ${err.message}`;
  }
}

</script>

<!-- trigger Akordion (jika dihapus body kosong) -->

<script>
document
  .getElementById('accordionExample')
  .addEventListener('shown.bs.collapse', function (e) {
    const item = e.target.closest('.accordion-item');
    loadAccordionContent(item);
  });
</script>

<script>
  
  /* pagination */
  
  
  function paginateText(text, options = {}) {
  const charsPerPage = options.charsPerPage || 0;

  const paragraphs = text
    .split(/\n{2,}/)
    .map(p => p.trim())
    .filter(Boolean);

  const pages = [];
  let buffer = '';

  paragraphs.forEach(p => {
    if ((buffer + p).length > charsPerPage) {
      pages.push(buffer);
      buffer = p + '\n\n';
    } else {
      buffer += p + '\n\n';
    }
  });

  if (buffer) pages.push(buffer);
  return pages;
}




/* render */

function renderPagination(container, pages) {
  let current = 0;

  const content = document.createElement('div');
  const nav = document.createElement('div');

  nav.className = 'd-flex justify-content-between align-items-center my-3';

  const btnPrev = document.createElement('button');
  btnPrev.textContent = '‚¨ÖÔ∏è';
  btnPrev.className = 'btn btn-sm btn-outline-secondary';

  const btnNext = document.createElement('button');
  btnNext.textContent = '‚û°Ô∏è';
  btnNext.className = 'btn btn-sm btn-outline-secondary';

  const info = document.createElement('span');

  function update() {
    content.innerHTML = pages[current].replace(/\n/g, '<br>');
    info.textContent = `${current + 1} / ${pages.length}`;
    btnPrev.disabled = current === 0;
    btnNext.disabled = current === pages.length - 1;
  }

  btnPrev.onclick = () => {
    if (current > 0) {
      current--;
      update();
    }
  };

  btnNext.onclick = () => {
    if (current < pages.length - 1) {
      current++;
      update();
    }
  };

  nav.append(btnPrev, info, btnNext);
  container.innerHTML = 'üîé';
  container.append(content, nav);

  update();
  }
</script>

    <!-- halaman Komentar -->
  <!--  <section class="comments">
      <script src="https://utteranc.es/client.js"
              repo="lasus023-jpg/00"
              issue-term="pathname"
              theme="github-light"
              crossorigin="anonymous"
              async>
      </script>
    </section> -->
   
 

</body>
</html>
